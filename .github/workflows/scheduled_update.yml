name: Scheduled HLS Playlist Update

on:
  # Runs every 30 minutes (CRON syntax)
  schedule:
    - cron: '*/30 * * * *' 
  # Allows manual running from the 'Actions' tab
  workflow_dispatch: 

jobs:
  update_playlist:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        # Downloads your repository files
        uses: actions/checkout@v4
        
      - name: Set up Python
        # Installs Python environment
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'
          
      - name: Install dependencies (requests)
        # Installs the Python library needed for scraping
        run: pip install requests
        
      - name: Run Playlist Generation Script
        # Executes your Python file (generate_playlist.py)
        run: python generate_playlist.py
        
      - name: Commit and Push new M3U8 file
        # üõ†Ô∏è CORRECTED ACTION: Uses the stable, working git-auto-commit action üõ†Ô∏è
        uses: peter-evans/git-auto-commit-action@v3
        with:
          commit_message: 'ü§ñ Playlist update: new HLS links'
          files: playlist.m3u8
          branch: main # Change to 'master' if that is your primary branch
